# eat2track

Телеграм мини-приложение для учета питания с упором на быстрое редактирование КБЖУ и работу с собственным каталогом продуктов.

## Возможности MVP
- Слайдер по дням недели с подсветкой сегодняшнего дня.
- Сводка КБЖУ выбранного дня.
- Список продуктов дня с возможностью менять вес или прямо корректировать КБЖУ сохраненной позиции.
- Добавление нового продукта: поиск с историей запросов и ручной ввод с расчетом на выбранный вес.

## Запуск
1. Установите зависимости (нужен Node 20+ — Vercel тоже использует 20.x):
   ```bash
   npm install
   npm run dev
   ```
   > Если видите ошибку `No matching version found for @twa-dev/sdk`, удалите старый `package-lock.json`/кеш установки: зависимость зафиксирована на стабильной версии `7.10.0` (без RC) и должна устанавливаться без отклонений.
2. Скопируйте `.env.example` в `.env` и подставьте свои Supabase ключи (формат Vite):
   ```bash
   cp .env.example .env
   ```

   > В CI или на Vercel заведите переменные окружения `VITE_SUPABASE_URL` и `VITE_SUPABASE_ANON_KEY` — без них сборка упадёт.
3. При локальной разработке можно фиксировать Node версию через `.nvmrc` (`nvm use`), чтобы избежать дрейфа версии.

## Переменные окружения
- `VITE_SUPABASE_URL` — URL проекта Supabase.
- `VITE_SUPABASE_ANON_KEY` — публичный anon-key.

### Деплой на Vercel
- Vercel автоматически определит Vite и соберёт приложение командой `npm run build`. Фронтенд лежит в `dist`.
- Чтобы избежать ошибки `@npmcli/ci-detect` из-за несовместимой версии Node, задайте в проекте переменную окружения `NODE_VERSION=20` (или поставьте значение в настройках Build & Development Settings). Также можно подключить `.nvmrc` — он фиксирует локальную версию 20.
- При необходимости можно переопределить команды и выходную директорию в `vercel.json` (уже добавлен в репозиторий).

### Локальная установка зависимостей
Если npm-репозиторий блокируется корпоративной политикой, можно использовать публичный прокси или локальный .npmrc. В CI (Vercel) стандартный доступ к registry.npmjs.org необходим для установки зависимостей.

## Стек
- React + TypeScript + Vite
- Zustand для стейта (готов к использованию, подключение supabase-js для последующей синхронизации).
